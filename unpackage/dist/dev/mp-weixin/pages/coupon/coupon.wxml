<view class="coupon-page"><view class="coupon-header"><view class="coupon-header__title-bar"><view class="coupon-header__title-bar-left"><view class="coupon-header__title">{{headerTitle}}</view><view class="coupon-header__subtitle">{{headerSubtitle}}</view></view><block wx:if="{{isSuperAdmin}}"><view class="coupon-header__title-bar-right"><u-button vue-id="62b22a80-1" type="primary" size="mini" plain="{{true}}" data-event-opts="{{[['^click',[['openCreateCoupon']]]]}}" bind:click="__e" bind:__l="__l" vue-slots="{{['default']}}"> 新增优惠券 </u-button></view></block></view></view><u-gap vue-id="62b22a80-2" height="20" bind:__l="__l"></u-gap><block wx:if="{{$root.g0}}"><view><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="__i0__" wx:key="id"><view class="coupon-card"><view class="coupon-card__left"><text class="coupon-card__currency">￥</text><text class="coupon-card__amount">{{item.$orig.discountAmount}}</text></view><view class="coupon-card__right"><view class="coupon-card__header-row"><view class="coupon-card__name">{{item.$orig.couponName}}</view><block wx:if="{{isSuperAdmin}}"><view class="coupon-card__admin-actions"><u-icon vue-id="{{'62b22a80-3-'+__i0__}}" name="edit-pen" size="28" color="#ee2f37" data-event-opts="{{[['^click',[['openEditCoupon',['$0'],[[['couponList','id',item.$orig.id]]]]]]]}}" bind:click="__e" bind:__l="__l"></u-icon><u-icon vue-id="{{'62b22a80-4-'+__i0__}}" name="trash" size="28" color="#fa3534" data-event-opts="{{[['^click',[['handleDeleteCoupon',['$0'],[[['couponList','id',item.$orig.id]]]]]]]}}" bind:click="__e" bind:__l="__l"></u-icon></view></block></view><view class="coupon-card__meta"><view class="coupon-card__meta-item"><text class="coupon-card__meta-label">等级</text><text class="coupon-card__meta-value">{{item.m0}}</text></view><view class="coupon-card__meta-item"><text class="coupon-card__meta-label">兑换积分</text><text class="coupon-card__meta-value">{{item.$orig.needPoints}}</text></view><view class="coupon-card__meta-item"><text class="coupon-card__meta-label">消费金额</text><text class="coupon-card__meta-value">{{item.m1}}</text></view></view><view class="coupon-card__actions"><u-button vue-id="{{'62b22a80-5-'+__i0__}}" type="error" size="mini" disabled="{{!item.m2}}" data-event-opts="{{[['^click',[['redeemCoupon',['$0'],[[['couponList','id',item.$orig.id]]]]]]]}}" bind:click="__e" bind:__l="__l" vue-slots="{{['default']}}">{{item.m3}}</u-button></view></view></view></block></view></block><block wx:else><u-empty vue-id="62b22a80-6" text="暂无可用优惠券" mode="coupon" bind:__l="__l"></u-empty></block><u-popup bind:input="__e" vue-id="62b22a80-7" mode="center" border-radius="16" mask-close-able="{{false}}" value="{{couponModalVisible}}" data-event-opts="{{[['^input',[['__set_model',['','couponModalVisible','$event',[]]]]]]}}" bind:__l="__l" vue-slots="{{['default']}}"><view class="coupon-form"><view class="coupon-form__title">{{isEditing?'修改优惠券':'新增优惠券'}}</view><u-form vue-id="{{('62b22a80-8')+','+('62b22a80-7')}}" model="{{couponForm}}" label-position="top" bind:__l="__l" vue-slots="{{['default']}}"><u-form-item vue-id="{{('62b22a80-9')+','+('62b22a80-8')}}" label="优惠券名称" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('62b22a80-10')+','+('62b22a80-9')}}" placeholder="请输入优惠券名称" value="{{couponForm.couponName}}" data-event-opts="{{[['^input',[['__set_model',['$0','couponName','$event',[]],['couponForm']]]]]}}" bind:__l="__l"></u-input></u-form-item><u-form-item vue-id="{{('62b22a80-11')+','+('62b22a80-8')}}" label="优惠金额（支持小数）" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('62b22a80-12')+','+('62b22a80-11')}}" type="digit" placeholder="请输入优惠金额" value="{{couponForm.discountAmount}}" data-event-opts="{{[['^input',[['__set_model',['$0','discountAmount','$event',[]],['couponForm']]]]]}}" bind:__l="__l"></u-input></u-form-item><u-form-item vue-id="{{('62b22a80-13')+','+('62b22a80-8')}}" label="所需积分" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('62b22a80-14')+','+('62b22a80-13')}}" type="number" placeholder="请输入所需积分" value="{{couponForm.needPoints}}" data-event-opts="{{[['^input',[['__set_model',['$0','needPoints','$event',[]],['couponForm']]]]]}}" bind:__l="__l"></u-input></u-form-item><u-form-item vue-id="{{('62b22a80-15')+','+('62b22a80-8')}}" label="等级要求（为空表示无限制）" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('62b22a80-16')+','+('62b22a80-15')}}" type="number" placeholder="如需限制请输入等级数字" value="{{couponForm.needLevel}}" data-event-opts="{{[['^input',[['__set_model',['$0','needLevel','$event',[]],['couponForm']]]]]}}" bind:__l="__l"></u-input></u-form-item><u-form-item vue-id="{{('62b22a80-17')+','+('62b22a80-8')}}" label="最低订单金额（为空或0表示无限制）" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('62b22a80-18')+','+('62b22a80-17')}}" type="digit" placeholder="达到此金额才可使用，为空表示无限制" value="{{couponForm.minOrderAmount}}" data-event-opts="{{[['^input',[['__set_model',['$0','minOrderAmount','$event',[]],['couponForm']]]]]}}" bind:__l="__l"></u-input></u-form-item></u-form><view class="coupon-form__actions"><u-button vue-id="{{('62b22a80-19')+','+('62b22a80-7')}}" size="medium" plain="{{true}}" disabled="{{submitLoading}}" data-event-opts="{{[['^click',[['closeCouponModal']]]]}}" bind:click="__e" bind:__l="__l" vue-slots="{{['default']}}">取消</u-button><u-button vue-id="{{('62b22a80-20')+','+('62b22a80-7')}}" size="medium" type="primary" loading="{{submitLoading}}" data-event-opts="{{[['^click',[['submitCouponForm']]]]}}" bind:click="__e" bind:__l="__l" vue-slots="{{['default']}}">{{''+(isEditing?'保存修改':'确认新增')+''}}</u-button></view></view></u-popup></view>